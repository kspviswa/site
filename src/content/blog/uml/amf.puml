@startuml
header
Generated by Viz
end header
center footer Viz Â© All rights reserved. Copying allowed but attribution required.
skinparam handwritten true
skinparam ranksep 50
'!theme sketchy
!define osaPuml https://raw.githubusercontent.com/Crashedmind/PlantUML-opensecurityarchitecture2-icons/master
!include osaPuml/Common.puml
!include osaPuml/User/all.puml
!include osaPuml/Hardware/all.puml
!include osaPuml/Misc/all.puml
!include osaPuml/Server/all.puml
!include osaPuml/Site/all.puml

node "<$osa_iPhone>\nUser Equipment" as ue
cloud "gNodeB\n<$osa_wireless_network>" as ran
node 5gc as "5G Core NFs" #MistyRose {
'together {
node "Access & Mobility Function\n<$osa_firewall>" as amf
node "Session Management Function\n<$osa_ics_drive>" as smf
node "User Data Management\n<$osa_database>" as udm
node "Policy Control Function\n<$osa_contract>" as pcf
node "Authentication Server Function\n<$osa_id_card>" as ausf
node "Location Management Function\n<$osa_camera_web>" as lmf
node "User Plane Function\n<$osa_hub>" as upf
'}
}
cloud "Data Network\n<$osa_cloud>" as dn

ue <-> ran : 5G NR
ran <-> amf : N2 \nControlplane traffic
ran <-[#red]-> upf : N3 \nUserplane traffic
ue <.> amf : <b>N1</b>
amf <-[#blue]-> smf : <font color="blue">session info </font>
amf <-[#blue]-> pcf : <font color="blue">policy info </font>
amf <-[#blue]-> udm : <font color="blue">subscription info </font>
amf <-[#blue]-> ausf : <font color="blue">authentication keys </font>
amf <-[#blue]-> lmf : <font color="blue">  UE location info </font>
smf <-[#red]-> upf : PDU session rules
upf <-> dn : N6
@enduml