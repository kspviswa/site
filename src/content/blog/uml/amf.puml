@startuml
skinparam handwritten true
scale 2.5
'!theme sketchy
!define osaPuml https://raw.githubusercontent.com/Crashedmind/PlantUML-opensecurityarchitecture2-icons/master
!include osaPuml/Common.puml
!include osaPuml/User/all.puml
!include osaPuml/Hardware/all.puml
!include osaPuml/Misc/all.puml
!include osaPuml/Server/all.puml
!include osaPuml/Site/all.puml

node "User Equipment\n<$osa_iPhone>" as ue
node "gNodeB\n<$osa_wireless_network>" as ran
together{
node "Access & Mobility Function\n<$osa_firewall>" as amf
node "Session Management Function\n<$osa_ics_drive>" as smf
node "User Data Management\n<$osa_database>" as udm
node "Policy Control Function\n<$osa_contract>" as pcf
node "Authentication Server Function\n<$osa_id_card>" as ausf
node "Location Management Function\n<$osa_camera_web>" as lmf
}
node "User Plane Function\n<$osa_hub>" as upf
node "Data Network\n<$osa_cloud>" as dn

ue <-> ran : nas
ran <-> amf : ngap
ran <-> upf : N3 \nUserplane traffic
ue <.> amf : N2 \nControlplane traffic
amf <--> smf : session info
amf <--> pcf : policy info
amf <--> udm : subscription info
amf <--> ausf : authentication keys
amf <--> lmf : location info
smf <--> upf : PDU session rules
upf <-> dn : N6
@enduml